resources:
  # Define an AWS::S3::BucketPolicy resource to grant Elastic Beanstalk access to the S3 bucket
  AWSEBLoadBalancerPermissions:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: contactnextlevelbuilders-recaptcha-json
      PolicyDocument:
        Statement:
          - Effect: Allow
            Principal:
              AWS: "*"
            Action:
              - "s3:GetObject"
            Resource:
              Fn::Join:
                - ""
                - - "arn:aws:s3:::"
                  - contactnextlevelbuilders-recaptcha-json
                  - "/*"

commands:
  # Copy the JSON file to the root directory of the application
  01_fetch_file_from_s3:
    command: aws s3 cp s3://contactnextlevelbuilders-recaptcha-json/nextlevelbuilder-1711565908511-5387e3f09914.json /var/app/current
